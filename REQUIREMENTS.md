# 需求确认文档

## 📋 用户需求

### 核心功能
1. **每天自动通知**
   - 时间：每天晚上 __ 点（待确认）
   - 内容：
     - 明天是否需要上班
     - 如果上班，显示班别（夜班/早班/中班）
     - 同班的人员名单

2. **班表上传**
   - 频率：每月一次
   - 方式：
     - [ ] 截图（需要 OCR）
     - [ ] Google Sheets（推荐）
     - [ ] Excel 文件上传
   - 权限：待确认（管理员？所有用户？）

3. **多单位支持**
   - 不同单位可以各自上传班表
   - 例如：M1组、A1组、N1组 等

### 用户流程

#### 首次使用
1. 用户加 LINE Bot 为好友
2. 用户绑定身份：`绑定 [姓名] [组别]`
   - 例如：`绑定 Jessica M1组`
3. 系统确认绑定成功

#### 日常使用
1. 每天自动收到明天的班表通知
2. 可以手动查询：
   - `明天上班吗`
   - `本周班表`
   - `谁跟我同班`

#### 管理员功能
1. 上传班表：
   - 发送 Excel 文件
   - 或提供 Google Sheets 链接
2. 查看统计信息

---

## ❓ 待确认问题

### 1. 通知时间
- [ ] 每天晚上几点发送通知？
- [ ] 用户可以自定义通知时间吗？

### 2. 用户绑定
- [ ] 用户如何绑定身份？
  - 选项 A：自己输入 `绑定 姓名 组别`
  - 选项 B：管理员统一导入（LINE ID ↔ 姓名）
  - 选项 C：其他方式

### 3. 班表上传
- [ ] 谁可以上传班表？
  - 选项 A：只有管理员
  - 选项 B：每个组有一个负责人
  - 选项 C：所有用户都可以上传自己组的班表

- [ ] 班表格式？
  - 选项 A：截图（需要 OCR，可能不准）
  - 选项 B：Google Sheets（推荐，准确且易更新）
  - 选项 C：Excel 文件上传
  - 选项 D：以上都支持

### 4. 同班判定规则
根据截图，班表有：
- 组别：M1, A1, N1 等
- 班别代码：N1, N2, N3, M1, M2, A1, A2 等

**"同班人员"的定义是？**

- [ ] 选项 A：同一组（M1组）+ 同一天都上班 = 同班
  - 例如：M1组的 Marjorie, Edo, Linda, Clay 在 11/8 都值班

- [ ] 选项 B：同一天 + 同一班别类型（都是夜班/早班/中班）= 同班
  - 例如：11/8 所有上夜班的人（不管哪个组）

- [ ] 选项 C：同一天 + 完全相同的班别代码（都是 N1）= 同班
  - 例如：11/8 所有班别是 N1 的人

- [ ] 选项 D：其他规则？

### 5. 班表数据
- [ ] 班表通常包含多少天？
  - 一个月？两周？

- [ ] 班表更新频率？
  - 每月初上传新月份的班表？
  - 可能临时调整吗？

### 6. 部署环境
- [ ] 你有服务器吗？
  - 云服务器（推荐，24/7 运行）
  - 本地电脑（需要一直开机）

- [ ] 预算考虑？
  - 免费方案（Google Cloud Free Tier, Heroku 等）
  - 付费服务器

---

## 🎯 推荐方案

基于你的需求，我推荐：

### 技术架构
```
LINE Bot (Flask)
├── 数据库 (SQLite 或 PostgreSQL)
│   ├── 用户表 (LINE ID, 姓名, 组别, 通知时间)
│   ├── 班表表 (日期, 员工, 班别, 组别)
│   └── 通知记录表
├── 班表解析模块
│   ├── Excel 解析器 ✅ (已完成)
│   ├── Google Sheets API
│   └── OCR 引擎 (可选)
├── 定时任务模块
│   └── APScheduler (每天定时发送通知)
└── 消息推送模块
    └── LINE Push API
```

### 开发阶段
1. **阶段 1：基础功能** (1-2 天)
   - 用户绑定
   - 手动查询班表
   - Excel 上传和解析

2. **阶段 2：自动通知** (1 天)
   - 定时任务
   - 消息推送

3. **阶段 3：进阶功能** (1-2 天)
   - Google Sheets 集成
   - 多组别支持
   - 统计报表

4. **阶段 4：部署** (1 天)
   - 云服务器部署
   - 域名和 HTTPS 设置

---

## 📝 下一步

请回答上面的待确认问题，我会根据你的答案开始实现系统！

如果有任何不清楚的地方，随时问我。
