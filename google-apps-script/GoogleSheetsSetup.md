# Google Sheets 设置指南

## 📊 创建 Google Sheets

### 第一步：创建新的 Google Sheets

1. 打开 Google Drive：https://drive.google.com
2. 点击左上角「新建」→「Google 试算表」→「空白试算表」
3. 重命名为：`班表管理系统`

---

## 📋 设置 Sheet 结构

你需要创建 4 个 Tab（工作表），按照以下格式设置：

### Tab 1：用户配置

**Tab 名称：** `用户配置`

**列结构：**
| LINE User ID | 姓名 | 模式 | 组别 |
|--------------|------|------|------|
| Uxxxx123 | Jessica | 完整 | M1组 |
| Uxxxx456 | John | 简化 | |

**说明：**
- `LINE User ID`：系统自动记录，用户绑定后会自动填入
- `姓名`：员工姓名
- `模式`：`完整` 或 `简化`
- `组别`：完整模式需要填写，简化模式留空

**你不需要手动填写，当用户在 LINE 输入「绑定」命令后，系统会自动添加记录。**

---

### Tab 2：完整班表

**Tab 名称：** `完整班表`

**列结构（示例）：**
| 日期 | Jessica | Sam | Marjorie | Edo | Linda | Clay |
|------|---------|-----|----------|-----|-------|------|
| 11/1 | M1 | N2 | M3 | M2 | O | M1 |
| 11/2 | M2 | N1 | M1 | M3 | M1 | O |
| 11/3 | O | N3 | O | M1 | M2 | M1 |
| ...  | ... | ... | ... | ... | ... | ... |

**格式要求：**
1. **第一行**（标题行）：
   - 第一列：`日期`
   - 其他列：员工姓名（必须与「用户配置」中的姓名完全一致）

2. **数据行**：
   - 第一列：日期，格式为 `11/1`, `11/2` 等（月/日）
   - 其他列：班别代码，如 `N1`, `M2`, `A1`, `O`, `P` 等

3. **支持的班别代码**：
   - `N`, `N1`, `N2`, `N3`：夜班
   - `M`, `M1`, `M2`, `M3`：早班
   - `A`, `A1`, `A2`：中班
   - `O`：休息
   - `P`：休假
   - `SL`：病假
   - `ML`, `AL`, `PL`：其他休假
   - `BTD`：出差

**如何填写：**
- 你可以直接从现有的 Excel 班表复制粘贴
- 或者手动输入
- 每月更新一次即可

---

### Tab 3：组别配置

**Tab 名称：** `组别配置`

**列结构：**
| 组别 | 成员列表 |
|------|----------|
| M1组 | Jessica,Marjorie,Edo,Linda,Clay |
| A1组 | Ricky,Aria,Jerry,Lina,Ivan |
| N1组 | Sam,You,Sunny,Jim,Ann |

**格式要求：**
- `组别`：组别名称（必须与「用户配置」中的组别完全一致）
- `成员列表`：用逗号分隔的姓名列表，**不要有空格**

**用途：**
- 用于查询「同班人员」
- 系统会根据组别找到所有成员，然后查看他们明天的班别

---

### Tab 4：休息日记录

**Tab 名称：** `休息日记录`

**列结构：**
| 姓名 | 休息日列表 |
|------|------------|
| John | 2024-11-03,2024-11-10,2024-11-17,2024-11-24 |
| Mary | 2024-11-05,2024-11-12,2024-11-19,2024-11-26 |

**说明：**
- 这个 Tab 是给**简化模式**用户使用的
- 当用户在 LINE 输入「休息日 11/3,11/10,11/17」后，系统会自动添加或更新记录
- 日期格式：`YYYY-MM-DD`

**你不需要手动填写，系统会自动管理。**

---

## 🎨 美化建议（可选）

为了让表格更易读，你可以：

1. **标题行加粗**：选中第一行，点击「格式」→「粗体」
2. **冻结标题行**：选中第二行，点击「查看」→「冻结」→「1 行」
3. **添加颜色**：
   - 夜班（N 开头）：深蓝色背景
   - 早班（M 开头）：浅黄色背景
   - 中班（A 开头）：浅橙色背景
   - 休息（O）：灰色背景
   - 休假（P）：绿色背景

---

## 📝 示例 Google Sheet

### 完整示例：

#### Tab 1: 用户配置
```
| LINE User ID | 姓名    | 模式 | 组别  |
|--------------|---------|------|-------|
| Uxxxx123     | Jessica | 完整 | M1组  |
| Uxxxx124     | Sam     | 完整 | N1组  |
| Uxxxx456     | John    | 简化 |       |
```

#### Tab 2: 完整班表
```
| 日期  | Jessica | Sam | Marjorie | Edo | Linda | John |
|-------|---------|-----|----------|-----|-------|------|
| 11/1  | M1      | N2  | M3       | M2  | O     |      |
| 11/2  | M2      | N1  | M1       | M3  | M1    |      |
| 11/3  | O       | N3  | O        | M1  | M2    |      |
| 11/4  | M3      | O   | M2       | O   | M3    |      |
```
注意：John 列可以留空，因为他用简化模式

#### Tab 3: 组别配置
```
| 组别  | 成员列表                          |
|-------|----------------------------------|
| M1组  | Jessica,Marjorie,Edo,Linda,Clay  |
| N1组  | Sam,You,Sunny,Jim,Ann            |
```

#### Tab 4: 休息日记录
```
| 姓名 | 休息日列表                                                      |
|------|-----------------------------------------------------------------|
| John | 2024-11-03,2024-11-10,2024-11-17,2024-11-24                     |
```

---

## ⚠️ 重要注意事项

1. **Tab 名称必须完全一致**：
   - `用户配置`
   - `完整班表`
   - `组别配置`
   - `休息日记录`

   （包括中文字符，不能有空格或其他字符）

2. **姓名必须完全一致**：
   - 「用户配置」中的姓名
   - 「完整班表」标题行中的姓名
   - 「组别配置」中的成员姓名

   必须完全相同（包括大小写、空格）

3. **日期格式**：
   - 在「完整班表」中使用 `11/1` 格式（月/日）
   - 在「休息日记录」中系统会自动使用 `2024-11-01` 格式

4. **组别格式**：
   - 成员列表用**英文逗号**分隔
   - 不要有空格：`Jessica,Sam,John` ✅
   - 不要这样：`Jessica, Sam, John` ❌

---

## 🔐 设置共享权限

为了让 Apps Script 可以访问这个 Sheet，你需要：

1. 点击右上角「共享」按钮
2. 在「一般存取权」区域，选择：
   - 「知道连结的任何人」
   - 「检视者」（或「编辑者」，如果你想让其他人也能编辑）
3. 点击「完成」

---

## 📎 获取 Sheet ID

完成设置后，你需要获取 Sheet ID：

1. 查看浏览器网址栏
2. 复制 `/d/` 和 `/edit` 之间的那一段
3. 例如：`https://docs.google.com/spreadsheets/d/【这一段就是ID】/edit`

**这个 ID 在后面部署时会用到。**

---

## ✅ 检查清单

设置完成后，请确认：

- [ ] 创建了 4 个 Tab，名称完全正确
- [ ] Tab 1「用户配置」有正确的列标题
- [ ] Tab 2「完整班表」第一行是日期，第一列是姓名
- [ ] Tab 3「组别配置」列出了所有组别和成员
- [ ] Tab 4「休息日记录」有正确的列标题（可以先留空）
- [ ] 设置了共享权限
- [ ] 获取了 Sheet ID

---

## 🆘 常见问题

**Q: 我可以用不同的 Tab 名称吗？**
A: 可以，但需要修改 `Code.gs` 中的配置区：
```javascript
const SHEET_USERS = '你的Tab名称';
const SHEET_SCHEDULE = '你的Tab名称';
// ...
```

**Q: 我的班表有更多员工怎么办？**
A: 在「完整班表」中添加更多列即可，系统会自动识别。

**Q: 简化模式用户需要在「完整班表」中吗？**
A: 不需要。简化模式用户只需要在「用户配置」中绑定，然后设置休息日即可。

**Q: 可以中途修改班表吗？**
A: 可以！直接在 Google Sheets 中修改，系统会立即读取最新数据。

---

下一步：[部署 Apps Script](./DeployGuide.md)
